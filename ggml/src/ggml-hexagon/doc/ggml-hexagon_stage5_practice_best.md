# 5. 练习题目与最佳实践

## 入门路径与练习题目

### 入门路径

1.  **环境搭建**:
    - 成功编译并运行 `ggml` 的一个示例，并启用 Hexagon 后端。
2.  **理解数据流**:
    - 在 `ggml-hexagon.cpp` 中添加日志，跟踪一个 `ggml` 操作（如 `ggml_mul_mat`）从被调用到在 DSP 上执行完成的全过程。
3.  **理解 DSP 代码**:
    - 阅读 `htp/main.c` 和 `htp/matmul-ops.c`，理解 DSP 是如何接收任务并执行矩阵乘法的。
4.  **尝试修改**:
    - 在 `htp/matmul-ops.c` 中，修改矩阵乘法的实现（例如，将其改为一个简单的循环），并观察结果的变化。

### 练习题目

1.  **添加一个新的激活函数**:
    - **题目**: 在 `htp/unary-ops.c` 中，实现一个新的激活函数（如 `LeakyReLU`）。
    - **目标**: 学习如何添加一个新的 DSP 计算内核，并将其集成到 `ggml-hexagon` 后端中。
2.  **优化数据传输**:
    - **题目**: 找到一个可以优化的数据传输场景（例如，多个小的 `memcpy` 可以合并为一个大的），并进行优化。
    - **目标**: 学习如何分析和优化 CPU 与 DSP 之间的数据传输。
3.  **使用 HVX 指令**:
    - **题目**: 选择一个简单的操作（如向量加法），并使用 HVX intrinsics 来实现它。
    - **目标**: 学习如何使用 HVX SIMD 引擎来加速计算。

## 最佳实践

- **开发**:
  - **编写单元测试**: 为每个 DSP 计算内核编写单元测试，确保其正确性。
  - **使用性能分析工具**: 在开发过程中，持续使用 `hexagon-profiler` 等工具来监控性能，避免引入性能回退。
  - **代码注释**: 为关键的代码路径和算法添加详细的注释，方便他人理解。
- **维护**:
  - **持续集成 (CI)**: 搭建 CI 系统，自动编译和运行测试，确保代码质量。
  - **版本管理**: 使用清晰的版本号，并为每个版本提供详细的发布说明。
  - **文档同步**: 在修改代码的同时，及时更新相关的文档。
- **扩展**:
  - **保持接口稳定**: 尽量不要修改现有的 `ggml` 后端接口，以保持向后兼容性。
  - **模块化设计**: 在添加新功能时，尽量遵循现有的模块化设计，将不同的功能放到不同的文件中。
  - **考虑通用性**: 在实现新的计算内核时，考虑其是否可以被其他操作复用。
